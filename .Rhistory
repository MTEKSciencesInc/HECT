1/4
.25/1.25
1/5
.2/1.2
runApp()
runApp()
runApp()
runApp()
runApp()
1/(1+exp(-1))
1/(1+exp(-.8))
1/(1+exp(-(1+.75*.8)))
runApp()
runApp()
runApp()
runApp()
if (runif(1) <= p) beta = new_b
source('~/Documents/Egnyte/Private/sgolchi/Synbiotics/sim_funs.R')
source('~/Documents/Egnyte/Private/sgolchi/Synbiotics/sim_funs.R')
source('~/Documents/Egnyte/Private/sgolchi/Synbiotics/sim_funs.R', echo=TRUE)
pmean = 0
psd = 10
theta = 0
y = rnorm(N, 0, 1)
var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
pmean = 0
psd = 10
theta = 0
N = 1000
y = rnorm(N, 0, 1)
var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
post_mean
hist(post_mean)
mean(post_mean)
var
?sapply
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
post_var = 1 / (1 + 1/psd^2)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
hist(d0)
p_val = function(d, samp) {
sum(samp>d)/length(samp)
}
p_val(d0[1], d0)
p_val(d0[2], d0)
p_values = p_val(d0, samp = d0)
hist(p_values)
p_values = sapply(d0, p_val, samp = d0)
hist(p_values)
theta = 1
N = 1000
y = rnorm(N, 0, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
p_val = function(d, samp) {
sum(samp>d)/length(samp)
}
p_values = sapply(d0, p_val, samp = d0)
hist(p_values)
hist(d0)
theta = 1
N = 1000
y = rnorm(N, theta, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
p_val = function(d, samp) {
sum(samp>d)/length(samp)
}
p_values = sapply(d0, p_val, samp = d0)
hist(p_values)
hist(d0)
theta = 2
N = 1000
y = rnorm(N, theta, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
p_val = function(d, samp) {
sum(samp>d)/length(samp)
}
p_values = sapply(d0, p_val, samp = d0)
hist(d0)
hist(p_values)
d0 = sapply(post_mean, function(x) dnorm(2, x, post_var))
p_val = function(d, samp) {
sum(samp>d)/length(samp)
}
p_values = sapply(d0, p_val, samp = d0)
hist(p_values)
hist(d0)
qqplo(d0,d0)
qqplot(d0,d0)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
d1 = sapply(post_mean, function(x) dnorm(2, x, post_var))
qqplot(d0,d1)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
d1 = sapply(post_mean, function(x) dnorm(0, x, post_var))
qqplot(d0,d1)
p_values = sapply(d0, p_val, samp = d1)
hist(p_value)
hist(p_values)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
d1 = sapply(post_mean, function(x) dnorm(1, x, post_var))
p_values = sapply(d0, p_val, samp = d1)
hist(p_values)
d0 = sapply(post_mean, function(x) dnorm(0, x, post_var))
d1 = sapply(post_mean, function(x) dnorm(0, x, post_var))
p_values = sapply(d0, p_val, samp = d1)
hist(p_values)
quantile(d0, p = .005)
d1 = sapply(post_mean, function(x) dnorm(1, x, post_var))
theta = 0
N = 1000
y = rnorm(N, theta, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
quantile(d0, p = .005)
theta = 1
N = 1000
y = rnorm(N, theta, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
quantile(d0, p = .005)
p_des = function(theta) {
if(theta<0) p = 0.01 else p = 1/(1+exp(-theta))
}
th0 = seq(-3,3,.1)
plot(th0, p_des(th0), type = 'l')
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(2+exp(theta))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(2+exp(-theta))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(1+exp(-10*theta))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(1+exp(-10*theta^2))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(1+exp(-10*theta^5))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(1+exp(-theta^5))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(10+exp(-theta^5))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(100+exp(-theta^5))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(20+exp(-theta^5))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99+exp(-theta^5))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99+exp(-theta^2))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99+exp(-theta^6))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99+exp(-theta^3))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99+log(theta^3))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99-log(theta^3))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(99-exp(-theta^3))
}
plot(th0, sapply(th0, p_des), type = 'l')
#########################################
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(100-exp(theta^3))
}
plot(th0, sapply(th0, p_des), type = 'l')
exp(1.5^3)
sapply(th0, p_des)
exp(1.8^3)
exp(1.5^3)
exp(1.6^3)
exp(1.7^3)
exp(1.65^3)
exp(1.68^3)
exp(1.67^3)
exp(1.665^3)
exp(1.66^3)
exp(1.667^3)
exp(1.666^3)
exp(1.664^3)
exp()
exp(0)
log(80)
log(80)^1/3
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(100-exp(theta^(1.46)))
}
plot(th0, sapply(th0, p_des), type = 'l')
plot(th0, sapply(th0, p_des), type = 'l', xlim = c(-3, 2.9))
plot(th0, sapply(th0, p_des), type = 'l', xlim = c(-3, 2.5))
plot(th0, sapply(th0, p_des), type = 'l', xlim = c(-3, 2.8))
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(101-exp(theta^(1.46)))
}
plot(th0, sapply(th0, p_des), type = 'l', xlim = c(-3, 2.8))
3^1.5
3^1.8
3^1.3
3^.3
3^.5
3^.4
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(101-exp(theta^(.46)))
}
plot(th0, sapply(th0, p_des), type = 'l', xlim = c(-3, 2.8))
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(101-exp(theta^(1.36)))
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else p = 1/(101-exp(theta^(1.36)))
if (theta>=3) p = 0.05
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else {
if (theta<=3) p = 1/(101-exp(theta^(1.36))) else p = 0.05
}
}
plot(th0, sapply(th0, p_des), type = 'l')
th0 = seq(-4,4,length = 1000)
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else {
if (theta<2.99) p = 1/(101-exp(theta^(1.36))) else p = 0.05
}
}
plot(th0, sapply(th0, p_des), type = 'l')
p_des = function(theta) {
if(theta<=0) p = 0.01 else {
if (theta<2.89) p = 1/(101-exp(theta^(1.36))) else p = 0.05
}
}
plot(th0, sapply(th0, p_des), type = 'l')
ff = function(theta){
y = rnorm(N, theta, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
theta = seq(-4,4,length = 100)
f0 = ff(theta)
f0 = sapply(theta, ff)
plot(theta, ff)
plot(theta, f0)
N = 100000
f0 = sapply(theta, ff)
plot(theta, f0)
lines(theta, p_des(theta = ))
lines(theta, p_des(theta))
lines(theta, sapply(theta, p_des))
plot(theta, f0, ylim = c(0, .07))
lines(theta, sapply(theta, p_des))
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des))
y0 = rnorm(1, 2, 1)
post_mean0 = var * (pmean/psd^2 + y0)
lines(theta, dnorm(theta, post_mean0, post_var))
ff = function(theta){
y = rnorm(N, theta, 1)
post_var = 1 / (1 + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
plot(theta, f0, ylim = c(0, .07))
plot(theta, f0, ylim = c(0, .07))
lines(theta, sapply(theta, p_des), col = 'red')
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
y0 = rnorm(100, 2, 1)
post_var0 = 1 / (100 + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + y0)
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'red')
y0 = rnorm(1, 2, 1)
post_var0 = 1 / (1 + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + y0)
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
y0 = rnorm(100, 2, 1)
post_var0 = 1 / (100 + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + y0)
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
y0 = rnorm(100, 2, 1)
post_var0 = 1 / (100 + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + mean(y0))
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
pmean/psd^2 + mean(y0)
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
plot(theta, dnorm(theta, post_mean0, post_var0))
post_var0
post_mean0
y0 = rnorm(10, 2, 1)
post_var0 = 1 / (10 + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + mean(y0))
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
y0 = rnorm(10, 3, 1)
post_var0 = 1 / (10 + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + mean(y0))
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
n = 100
ff = function(theta){
y = rnorm(1, theta, 1/n)
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
plot(theta, f0)
n = 100
ff = function(theta){
y = rnorm(1, theta, 1/n)
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
length(theta)
length(ff)
length(f0)
p_des = function(theta) {
if(theta<=0) p = 0.01 else {
if (theta<2.89) p = 1/(101 - exp(theta^(1.36))) else p = 0.05
}
}
n = 100
ff = function(theta){
y = rnorm(1, theta, 1/n)
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
n = 100
ff = function(theta){
y = rnorm(N, theta, 1/n)
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
y0 = rnorm(1, 3, 1/n)
post_var0 = 1 / (n + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + n*y0)
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
y0 = rnorm(1, 2, 1/n)
post_var0 = 1 / (n + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + n*y0)
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
y0 = rnorm(1, 2.5, 1/n)
post_var0 = 1 / (n + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + n*y0)
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
plot(theta, f0, ylim = c(0, .07), type = 'l')
plot(theta, f0,  type = 'l')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
plot(theta, f0, ylim = c(0, .07), type = 'l')
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
plot(theta, dnorm(theta, post_mean0, post_var0), col = 'blue', type = 'l')
n = 100
ff = function(theta){
y = rnorm(N, theta, 1/n)
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
y0 = rnorm(1, 2.5, 1/n)
post_var0 = 1 / (n + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + n*y0)
plot(theta, f0, type = 'l')
plot(theta, f0, type = 'l', ylim = c(0, 6))
lines(theta, dnorm(theta, post_mean0, post_var0), col = 'blue')
ff(2.5)
y = rnorm(N, theta, 1/n)
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, post_var))
hist(d0)
hist(d0[d0<10])
hist(d0[d0<1])
hist(d0[d0<.1])
hist(d0[d0<.01])
hist(d0[d0<.001])
post_mean
hist(post_mean)
post_var
y = rnorm(N, theta, sqrt(1/n))
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, sqrt(post_var)))
hist(d0)
hist(d0[d0<1])
hist(d0[d0<.1])
hist(d0[d0<.01])
hist(d0[d0<.001])
q = quantile(d0, p_des(theta))
theta
tehta = 2.5
theta = 2.5
y = rnorm(N, theta, sqrt(1/n))
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, sqrt(post_var)))
q = quantile(d0, p_des(theta))
q
hist(d0)
n = 100
ff = function(theta){
y = rnorm(N, theta, sqrt(1/n))
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, sqrt(post_var)))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
theta = seq(-4,4,length = 100)
n = 100
ff = function(theta){
y = rnorm(N, theta, sqrt(1/n))
post_var = 1 / (n + 1/psd^2)
post_mean = post_var * (pmean/psd^2 + n*y)
d0 = sapply(post_mean, function(x) dnorm(theta, x, sqrt(post_var)))
q = quantile(d0, p_des(theta))
return(q)
}
f0 = sapply(theta, ff)
y0 = rnorm(1, 2.5, sqrt(1/n))
post_var0 = 1 / (n + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + n*y0)
plot(theta, f0, type = 'l', ylim = c(0, 6))
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, sqrt(post_var0)), col = 'blue')
plot(theta, f0, type = 'l', ylim = c(0, 2))
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, sqrt(post_var0)), col = 'blue')
y0 = rnorm(1, 2.8, sqrt(1/n))
post_var0 = 1 / (n + 1/psd^2)
post_mean0 = post_var0 * (pmean/psd^2 + n*y0)
plot(theta, f0, type = 'l', ylim = c(0, 2))
lines(theta, sapply(theta, p_des), col = 'red')
lines(theta, dnorm(theta, post_mean0, sqrt(post_var0)), col = 'blue')
tp = 50:100
plot(theta[tp], f0[tp], type = 'l', ylim = c(0, 2))
lines(theta[tp], sapply(theta[tp], p_des), col = 'red')
lines(theta[tp], dnorm(theta[tp], post_mean0, sqrt(post_var0)), col = 'blue')
